Appcelerator.UI.registerUIComponent("control","select",{selectOptions:{},currentOptions:{},activeThemes:{},activeSelects:{},selectCount:1000,getAttributes:function(){var A=Appcelerator.Types;return[{name:"width",optional:true,description:"container width for select ",defaultValue:"100px"}]},getVersion:function(){return"3.0.0"},getSpecVersion:function(){return 1},value:function(A,D,F,O,H,M,J,E){var C=Appcelerator.Compiler.findParameter(M,"property");var Q=Appcelerator.Compiler.findParameter(M,"row");var K=Appcelerator.Compiler.findParameter(M,"value")||"value";var N=Appcelerator.Compiler.findParameter(M,"text")||"text";if(!C){throw"required parameter named 'property' not found in value parameter list"}if(!N){N=K}var L=[];var G="";var P=$(A+"_combo_box");if(C){P.innerHTML="";for(var I=0;I<C.length;I++){if(Q){var B=Object.getNestedProperty(C[I],Q)}else{var B=C[I]}if(B){G+='<div id="'+A+"_combo_"+I+'" class="select_'+this.activeThemes[A]+'_dropdown_item" on="click then l:'+A+"_combo_rowclick[row="+I+"] or mouseover then add[class=select_"+this.activeThemes[A]+"_dropdown_hover] and l:"+A+"_combo_mouseover[row="+I+"] or mouseout then remove[class=select_"+this.activeThemes[A]+'_dropdown_hover]">'+Object.getNestedProperty(B,N)+"</div>";L.push({index:I,id:A+"_combo_"+I,value:Object.getNestedProperty(B,K),text:Object.getNestedProperty(B,N)})}}P.innerHTML=G;Appcelerator.Compiler.destroy(P);Appcelerator.Compiler.dynamicCompile(P);this.selectOptions[A]=L;this.currentOptions[A]=L;this.activeSelects[A].selectedIndex=0;this.activeSelects[A].lastOption=C.length-1;Appcelerator.Compiler.fireCustomCondition(A,"change",{id:A,value:this.currentOptions[A][this.activeSelects[A].selectedIndex].text});this._setValue(A,this.currentOptions[A][this.activeSelects[A].selectedIndex].text);$(A+"_combo_box").style.height=this._getDropdownHeight(C.length)}},reset:function(H,G,E,C,A,B,F,D){this.activeSelects[H].selectedIndex=0;this._setValue(H,this.currentOptions[H][this.activeSelects[H].selectedIndex].text);Appcelerator.Compiler.fireCustomCondition(H,"change",{id:H,value:this.currentOptions[H][this.activeSelects[H].selectedIndex].text})},selectOption:function(A,B,E,L,G,K,H,C){var J=K[0].key;var I=E[J];var F=this.selectOptions[A];for(var D=0;D<F.length;D++){if(F[D].value==I){Element.removeClassName($(A+"_combo_"+this.activeSelects[A].selectedIndex),"select_"+this.activeThemes[A]+"_dropdown_hover");this.activeSelects[A].selectedIndex=D;Appcelerator.Compiler.fireCustomCondition(A,"change",{id:A,value:this.currentOptions[A][this.activeSelects[A].selectedIndex].text});this._setValue(A,F[D].text);return }}},getActions:function(){return["value","reset","selectOption"]},toggle_list:function(E,D,C,B,A){},change:function(E,C,D,B,A){},getConditions:function(){return["change","toggle_list"]},build:function(G,D){var H=D.theme||Appcelerator.UI.UIManager.getDefaultTheme("select");var C=this;var A=(G.getAttribute("on"))?'on="'+G.getAttribute("on")+'"':"";var B=G.options;C.activeThemes[G.id]=H;C.activeSelects[G.id]={};C.activeSelects[G.id].selectedIndex=-1;C.activeSelects[G.id].lastOption=(G.options)?G.options.length-1:-1;var F=null;if(Appcelerator.Browser.isIE){F='<span id="'+G.id+'"  class="select_'+H+'" '+A+' style="z-index:'+C.selectCount+'">';C.selectCount--}else{F='<span id="'+G.id+'"  class="select_'+H+'" '+A+">"}var E=Appcelerator.Core.getModuleCommonDirectory()+"/images/appcelerator/blank.gif";F+='<span id="'+G.id+'_container" class="select_'+H+'" style="position:relative">';F+='<input style="width:'+D.width+';" type="text" id="'+G.id+'_input" class="select_'+H+'_input"/>';F+='<img id="'+G.id+'_combo_img" src="'+E+'" class="select_'+H+'_arrow"/>';F+='<div id="'+G.id+'_combo_box" style="display:none;width:'+D.width+';" class="select_'+H+'_dropdown">';F+=C._getOptions(G,H);F+="</div></span></span>";new Insertion.Before(G,F);Event.observe($(G.id+"_combo_img"),"click",function(I){Appcelerator.Compiler.fireCustomCondition(G.id,"toggle_list",{id:G.id});C._toggleList(G.id)});$MQL(G.id+"_combo_rowclick",function(J,K,I,L){Appcelerator.Compiler.fireCustomCondition(G.id,"change",{id:G.id,value:C.currentOptions[G.id][C.activeSelects[G.id].selectedIndex].text});Appcelerator.Compiler.fireCustomCondition(G.id,"toggle_list",{id:G.id});C._setValue(G.id,C.currentOptions[G.id][K.row].text);C.activeSelects[G.id].selectedIndex=K.row});$MQL(G.id+"_combo_mouseover",function(J,K,I,L){if(K.row!=C.activeSelects[G.id].selectedIndex){Element.removeClassName($(G.id+"_combo_"+C.activeSelects[G.id].selectedIndex),"select_"+H+"_dropdown_hover");C.activeSelects[G.id].selectedIndex=K.row}});Event.observe($(G.id+"_input"),"click",function(I){Appcelerator.Compiler.fireCustomCondition(G.id,"toggle_list",{id:G.id});C._toggleList(G.id);Event.stop(I)});Event.observe(document,"click",function(I){I=Event.getEvent(I);var J=Event.element(I);if(($(G.id+"_combo_box").style.display!="none")&&(J.id!==G.id+"_combo_img")){Appcelerator.Compiler.fireCustomCondition(G.id,"toggle_list",{id:G.id});C._toggleList(G.id);Event.stop(I)}});$(G.id+"_input").onkeyup=function(I){(function(){I=I||window.event;switch(I.keyCode){case Event.KEY_TAB:case Event.KEY_LEFT:case Event.KEY_RIGHT:case Event.KEY_ESC:Appcelerator.Compiler.fireCustomCondition(G.id,"toggle_list",{id:G.id});C._toggleList(G.id);Appcelerator.Compiler.fireCustomCondition(G.id,"change",{id:G.id,value:C.activeSelects[G.id].startValue});C._setValue(G.id,C.activeSelects[G.id].startValue);Element.removeClassName($(G.id+"_combo_"+C.activeSelects[G.id].selectedIndex),"select_"+H+"_dropdown_hover");C.activeSelects[G.id].selectedIndex=C.activeSelects[G.id].startIndex;Event.stop(I);return ;case Event.KEY_RETURN:Appcelerator.Compiler.fireCustomCondition(G.id,"change",{id:G.id,value:C.currentOptions[G.id][C.activeSelects[G.id].selectedIndex].text});Appcelerator.Compiler.fireCustomCondition(G.id,"toggle_list",{id:G.id});C._setValue(G.id,C.currentOptions[G.id][C.activeSelects[G.id].selectedIndex].text);C._toggleList(G.id);Event.stop(I);return ;case Event.KEY_UP:if(C.activeSelects[G.id].selectedIndex>0){Element.removeClassName($(G.id+"_combo_"+C.activeSelects[G.id].selectedIndex),"select_"+H+"_dropdown_hover");C.activeSelects[G.id].selectedIndex--;Appcelerator.Compiler.fireCustomCondition(G.id,"change",{id:G.id,value:C.currentOptions[G.id][C.activeSelects[G.id].selectedIndex].text});C._setValue(G.id,C.currentOptions[G.id][C.activeSelects[G.id].selectedIndex].text);Element.addClassName($(G.id+"_combo_"+C.activeSelects[G.id].selectedIndex),"select_"+H+"_dropdown_hover")}Event.stop(I);return ;case Event.KEY_DOWN:if(C.activeSelects[G.id].lastOption!=C.activeSelects[G.id].selectedIndex){Element.removeClassName($(G.id+"_combo_"+C.activeSelects[G.id].selectedIndex),"select_"+H+"_dropdown_hover");C.activeSelects[G.id].selectedIndex++;Appcelerator.Compiler.fireCustomCondition(G.id,"change",{id:G.id,value:C.currentOptions[G.id][C.activeSelects[G.id].selectedIndex].text});C._setValue(G.id,C.currentOptions[G.id][C.activeSelects[G.id].selectedIndex].text);Element.addClassName($(G.id+"_combo_"+C.activeSelects[G.id].selectedIndex),"select_"+H+"_dropdown_hover")}Event.stop(I);return ;default:if($(G.id+"_combo_box").style.display=="none"){Appcelerator.Compiler.fireCustomCondition(G.id,"toggle_list",{id:G.id});C._toggleList(G.id)}var J=C.selectOptions[G.id];var K=[];for(var L=0;L<J.length;L++){if(J[L].text.toLowerCase().startsWith($(G.id+"_input").value.toLowerCase())==true){K.push(J[L])}}C._updateOptions(G,K,H);C.currentOptions[G.id]=K;C.activeSelects[G.id].lastOption=K.length-1;C.activeSelects[G.id].selectedIndex=0;$(G.id+"_combo_box").style.height=C._getDropdownHeight(K.length);Element.addClassName($(G.id+"_combo_0"),"select_"+H+"_dropdown_hover")}})()};Appcelerator.Compiler.removeElementId(G.id);Element.remove(G);Appcelerator.Compiler.dynamicCompile($(G.id+"_container"));$(G.id).widget={};$(G.id).widget.getValue=function(K,J){var I=C._getIndexForValue(G.id,$(G.id+"_input").value);return C.currentOptions[G.id][I].value};$(G.id+"_combo_box").style.height=this._getDropdownHeight(B.length);this._setValue(G.id,this.currentOptions[G.id][this.activeSelects[G.id].selectedIndex].text);Appcelerator.Core.loadTheme("control","select",H,G,D)},_updateOptions:function(D,A,F){var E=$(D.id+"_combo_box");var C="";for(var B=0;B<A.length;B++){C+='<div id="'+D.id+"_combo_"+B+'" class="select_'+F+'_dropdown_item" on="click then l:'+D.id+"_combo_rowclick[row="+B+"] or mouseover then add[class=select_"+F+"_dropdown_hover] and l:"+D.id+"_combo_mouseover[row="+B+"] or mouseout then remove[class=select_"+F+'_dropdown_hover]">'+A[B].text+"</div>"}E.innerHTML=C;Appcelerator.Compiler.destroy(E);Appcelerator.Compiler.dynamicCompile(E)},_getDropdownHeight:function(A){if(A<20){return(A*17)+"px"}},_getOptions:function(D,E){if(D.options){var C="";var A=[];for(var B=0;B<D.options.length;B++){C+='<div id="'+D.id+"_combo_"+B+'" class="select_'+E+'_dropdown_item" on="click then l:'+D.id+"_combo_rowclick[row="+B+"] or mouseover then add[class=select_"+E+"_dropdown_hover] and l:"+D.id+"_combo_mouseover[row="+B+"] or mouseout then remove[class=select_"+E+'_dropdown_hover]">'+D.options[B].text+"</div>";A.push({index:B,id:D.id+"_combo_"+B,value:D.options[B].value,text:D.options[B].text})}this.selectOptions[D.id]=A;this.currentOptions[D.id]=A;this.activeSelects[D.id].selectedIndex=0;return C}return""},_toggleList:function(A){if($(A+"_combo_box").style.display=="none"){this.activeSelects[A].startValue=$(A+"_input").value;this.activeSelects[A].startIndex=this.activeSelects[A].selectedIndex=this._getIndexForValue(A,this.activeSelects[A].startValue);Element.addClassName($(A+"_combo_"+this.activeSelects[A].selectedIndex),"select_"+this.activeThemes[A]+"_dropdown_hover")}Element.toggle(A+"_combo_box")},_setValue:function(B,A){$(B+"_input").value=A},_getIndexForValue:function(C,B){for(var A=0;A<this.currentOptions[C].length;A++){if(this.currentOptions[C][A].text==B){return A}}return -1}});