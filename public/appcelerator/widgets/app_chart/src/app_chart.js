Appcelerator.Widget.Chart={flashRequired:true,flashVersion:8,getName:function(){return"appcelerator chart"},getDescription:function(){return"chart widget"},getVersion:function(){return"__VERSION__"},getSpecVersion:function(){return 1},getAuthor:function(){return"Amro Mousa"},getModuleURL:function(){return"http://www.appcelerator.org"},isWidget:function(){return true},getWidgetName:function(){return"app:chart"},getActions:function(){return["execute","update"]},getAttributes:function(){var A=Appcelerator.Types;return[{name:"on",optional:false,description:"Used to display the chart.",type:A.onExpr},{name:"type",optional:false,defaultValue:"",description:"enumerated value, or property on payload to find value",type:A.openEnumeration("bar","pie","line")},{name:"title",optional:true,defaultValue:"",description:"Title displayed at the top of the chart."},{name:"color",optional:true,defaultValue:"#477398",description:"Specifies the base color of the chart or the color for each bar/slice/line . You can provide a single hex color or csv color list"},{name:"angle",optional:true,defaultValue:"15",type:A.number,description:"Angle for '3D' graphs, bar and pie (in degrees)"},{name:"thickness",optional:true,defaultValue:"15",type:A.number,description:"Thickness of '3D' graphs (in pixels)"},{name:"width",optional:true,defaultValue:"400",type:A.number,description:"The width of the chart (in pixels)"},{name:"height",optional:true,defaultValue:"360",type:A.number,description:"The height of the chart (in pixels)"},{name:"chartMode",optional:true,defaultValue:"clustered",description:"sub type for bar and line charts",type:A.openEnumeration("line","clustered","stacked","100% stacked")},{name:"barOrientation",optional:true,defaultValue:"400",type:A.number,description:'"vertical" or "horizontal" orientation for a bar chart'},{name:"rotateXAxisLabel",optional:true,defaultValue:"false",description:'"true" or "false". If "true" x axis labels are rotated by 90 degrees.'},{name:"rotateYAxisLabel",optional:true,defaultValue:"false",description:'"true" or "false". If "true" y axis labels are rotated by 90 degrees.'},{name:"legend",optional:true,defaultValue:"false",type:A.bool,description:'"true" or "false". If "true" a legend will be displayed.'},{name:"brightness_step",optional:true,defaultValue:"15",type:A.number,description:"How much the brightness of the chart increases"},{name:"textSize",optional:true,defaultValue:"11",type:A.number,description:"Font size (in pixels)"},{name:"property",optional:false,defaultValue:"",type:A.identifier,description:"The property of the message to use to populate the chart"},{name:"chartTitles",optional:true,defaultValue:"",description:"Array property name that contains the titles for the legend and labels composite bar charts."},{name:"fillAlpha",optional:true,defaultValue:"30",type:A.number,description:"Specifies the opacity of the shaded area under a line in a line chart (percentage)"},{name:"indicator",optional:true,defaultValue:"false",type:A.bool,description:"Enable a mouseover bubble to show the value of every line at a given x value on a line graph"},{name:"marginTop",optional:true,defaultValue:"80",type:A.number,description:"Specifies the space between the top of the chart and the start of the line or bar chart (pixels)"},{name:"marginLeft",optional:true,defaultValue:"50",type:A.number,description:"Specifies the space between the left of the chart and the start of the line or bar chart (pixels)"},{name:"marginRight",optional:true,defaultValue:"50",type:A.number,description:"Specifies the space between the right of the chart and the start of the line or bar chart (pixels)"},{name:"marginBottom",optional:true,defaultValue:"50",type:A.number,description:"Specifies the space between the bottom of the chart and the start of the line or bar chart (pixels)"},{name:"legendHighlight",optional:true,defaultValue:"true",type:A.bool,description:"Specifies whether the lines on the line chart will be 'highlighted' when one mouses over a legend value for that line."},{name:"backgroundColor",optional:true,defaultValue:"#FFFFFF"},{name:"radius",optional:true,defaultValue:"90",type:A.number},{name:"precision",optional:true,defaultValue:"2",type:A.number},{name:"innerRadius",optional:true,defaultValue:"30",type:A.number,description:"Specifies the radius of the 'hole' in the center of the pie chart (pixels)"},{name:"animation",optional:true,defaultValue:"true",type:A.bool},{name:"oneBalloon",optional:true,defaultValue:"false",type:A.bool,description:"Specifies whether an indicator balloon will be shown for all lines or only the line closest to the mouse pointer on the line graph. Possible values are 'true' or 'false'."},{name:"xAxisLabel",optional:true,defaultValue:""},{name:"xAxisYPosition",optional:true,defaultValue:"0",type:A.number},{name:"xAxisXPosition",optional:true,defaultValue:"0",type:A.number},{name:"yAxisLabel",optional:true,defaultValue:""},{name:"yAxisYPosition",optional:true,defaultValue:"0",type:A.number},{name:"yAxisXPosition",optional:true,defaultValue:"0",type:A.number},{name:"dataValueMax",optional:true,defaultValue:"0",type:A.number}]},buildWidget:function(B,C){var A='<div id="'+B.id+'"></div>';return{presentation:A,position:Appcelerator.Compiler.POSITION_REPLACE,parameters:C}},getDataAsCSV:function(D){var C="";for(var B=0,A=D.length;B<A;B++){C+=D[B]["name"]+","+D[B]["value"]+"\n"}return C},update:function(G,A,E){var B=A.property;if(B){var F=Object.getNestedProperty(E,B)||[];A.data=F;var D=Appcelerator.Widget.Chart.getDataAsCSV(F);try{$("chart_"+G).setData(D)}catch(C){Logger.info("Failed to set chart data for id: "+G)}}},execute:function(h,m,x){var AC=m.type;var c=m.title;var Z=m.color;var S=m.angle;var P=m.thickness;var A=m.width;var E=m.height;var k=m.chartMode;var T=m.barOrientation;var H=m.rotateXAxisLabel;var W=m.rotateYAxisLabel;var K=m.legend;var l=m.brightness_step;var AA=m.property;var e=m.chartTitles;var a=m.textSize;var M=m.fillAlpha;var g=m.indicator;var n=m.marginTop;var I=m.marginLeft;var AB=m.marginRight;var d=m.marginBottom;var Y=m.legendHighlight;var b=m.oneBalloon;var C=m.backgroundColor;var B=m.innerRadius;var o=m.radius;var v=m.precision;var V=m.yAxisLabel;var G=m.xAxisLabel;var u=m.yAxisXPosition;var N=m.yAxisYPosition;var J=m.xAxisXPosition;var f=m.xAxisYPosition;var y=m.dataValueMax;var z=m.animation;if(z!="false"&&AC.toLowerCase()=="pie"){z=2}else{if(z!="false"&&AC.toLowerCase()=="bar"){z=1}else{z=0}}if(y!=""){y=Object.getNestedProperty(x,y)||""}if(T.toLowerCase()!="vertical"&&T.toLowerCase()!="horizontal"){T=Object.getNestedProperty(x,T)||"vertical"}if(T.toLowerCase()=="horizontal"){T="bar"}else{T="column"}if(H.toLowerCase()=="true"){H=90}else{H=0}if(W.toLowerCase()=="true"){W=90}else{W=0}if(AA){array=Object.getNestedProperty(x,AA)||[];m.data=array}else{array=[]}if(c!=""){var w=Object.getNestedProperty(x,c);if(w==null){w="*[No Title]*"}if(w!="*[No Title]*"){c=w}}if(V!=""){var U=Object.getNestedProperty(x,V);if(U==null){U="*[No yAxisLabel]*"}if(U!="*[No yAxisLabel]*"){V=U}else{V=""}}if(G!=""){var F=Object.getNestedProperty(x,G);if(F==null){F="*[No xAxisLabel]*"}if(F!="*[No xAxisLabel]*"){G=F}else{G=""}}var X=Appcelerator.Widget.Chart.getDataAsCSV(array);if(AC.toLowerCase()!="bar"&&AC.toLowerCase()!="pie"&&AC.toLowerCase()!="line"&&AC.toLowerCase()!=""){AC=Object.getNestedProperty(x,AC,"")}if(AC.toLowerCase()=="bar"&&(k.toLowerCase()!="clustered"&&k.toLowerCase()!="stacked"&&k.toLowerCase()!="100% stacked")){k=Object.getNestedProperty(x,k,"clustered")}if(AC.toLowerCase()=="line"&&(k.toLowerCase()!="line"&&k.toLowerCase()!="stacked"&&k.toLowerCase()!="100% stacked")){k=Object.getNestedProperty(x,k,"line")}if(K.toLowerCase()!="true"&&K.toLowerCase()!="false"){K=Object.getNestedProperty(x,K,"false")}var p=Z.split(",");if(p.length>1&&AC.toLowerCase()=="pie"){p=Z;Z="";l=""}else{if(p.length==1&&AC.toLowerCase()=="pie"){p=""}}if(p.length>1&&AC.toLowerCase()=="bar"){Z=p[0]}var r="";if(AC.toLowerCase()=="bar"||AC.toLowerCase()=="line"){titleArray=Object.getNestedProperty(x,e)||[];m.titleArray=titleArray;var R="";if(AC.toLowerCase()=="bar"){R='<graph gid="{COL_NUM}"><type>column</type><title>{COL_TITLE}</title><color>{COL_COLOR}</color><alpha></alpha><data_labels><![CDATA[]]></data_labels><fill_alpha>'+M+"</fill_alpha></graph>"}else{if(AC.toLowerCase()=="line"){R="<graph><axis>left</axis><title>{COL_TITLE}</title><color>{COL_COLOR}</color><color_hover>FF0000</color_hover><fill_alpha>"+M+"</fill_alpha><balloon_text><![CDATA[{COL_TITLE} {value}]]></balloon_text></graph>"}}var j="";var t="";for(var s=0,Q=titleArray.length;s<Q;s++){j+=R.gsub("{COL_NUM}",s.toString()).gsub("{COL_TITLE}",titleArray[s]["title"]).gsub("{COL_COLOR}",p[s]||"")}if(titleArray.length==0){if(AC.toLowerCase()=="bar"){t='<graph gid="0"><type>column</type><title></title><color>'+Z+"</color><alpha></alpha><data_labels><![CDATA[]]></data_labels><fill_alpha>"+M+"</fill_alpha><width></width><bullet></bullet><bullet_size></bullet_size><bullet_color></bullet_color><gradient_fill_colors></gradient_fill_colors></graph>"}else{if(AC.toLowerCase()=="line"){for(var s=0;s<p.length;s++){t+="<graph><axis>left</axis><title></title><color>"+p[s]+"</color><color_hover>#FF0000</color_hover><fill_alpha>"+M+"</fill_alpha><balloon_text><![CDATA[]]></balloon_text></graph>"}}else{t="<graph><axis>left</axis><title></title><color>"+Z+"</color><color_hover>#FF0000</color_hover><fill_alpha>"+M+"</fill_alpha><balloon_text><![CDATA[]]></balloon_text></graph>"}}}else{t=j}var D=(titleArray.length>0)?"{title}":"{series}";if(k.toLowerCase()=="stacked"){r="<balloon_text><![CDATA["+D+": {value}]]></balloon_text>"}else{if(k.toLowerCase()=="100% stacked"){r="<balloon_text><![CDATA["+D+": {percents}%]]></balloon_text>"}else{if(k.toLowerCase()=="clustered"){r="<balloon_text><![CDATA["+D+": {value}]]></balloon_text>"}else{if(k.toLowerCase()=="line"){r="<balloon_text><![CDATA["+D+": {value}]]></balloon_text>"}}}}}var q=K?Math.floor(E*0.06):0;var O=E-q;var L;if(AC.toLowerCase()=="pie"){L=new SWFObject(Appcelerator.DocumentPath+"swf/ampie.swf","chart_"+h,A,E,"8","#FFFFFF");L.addVariable("chart_settings",escape("<settings><width/><height>"+O+"</height><data_type>csv</data_type><csv_separator>,</csv_separator><skip_rows>0</skip_rows><font>Arial</font><text_size>"+a+"</text_size><text_color>#000000</text_color><decimals_separator>.</decimals_separator><thousands_separator>,</thousands_separator><redraw/><reload_data_interval/><add_time_stamp>false</add_time_stamp><precision>"+v+"</precision><export_image_file/><exclude_invisible/><pie><x/><y></y><radius>"+o+"</radius><inner_radius>"+B+"</inner_radius><height>"+P+"</height><angle>"+S+"</angle><outline_color/><outline_alpha/><!-- main color --><base_color>"+Z+"</base_color><brightness_step>"+l+"</brightness_step><colors>"+p+"</colors><link_target/><alpha/></pie><animation><start_time>"+z+"</start_time><start_effect>strong</start_effect><start_radius/><start_alpha>0</start_alpha><pull_out_on_click/><pull_out_time>1.5</pull_out_time><pull_out_effect>Bounce</pull_out_effect><pull_out_radius/><pull_out_only_one/></animation><data_labels><radius/><text_color/><text_size/><max_width>140</max_width><show><![CDATA[{title}: {percents}%]]></show><show_lines/><line_color/><line_alpha/><hide_labels_percent>3</hide_labels_percent></data_labels><group><percent/><color/><title/><url/><description/><pull_out/></group><background><color>"+C+"</color><alpha>100</alpha><border_color/><border_alpha/><file/></background><balloon><enabled/><color/><alpha>80</alpha><text_color/><text_size/><show><![CDATA[{title}: {percents}%]]></show></balloon><legend><enabled>"+K+"</enabled><x/><y></y><width/><color>#FFFFFF</color><max_columns/><alpha>0</alpha><border_color>#000000</border_color><border_alpha>0</border_alpha><text_color/><text_size/><spacing>5</spacing><margins> <left>"+I+"</left> <top>"+n+"</top> <right>"+AB+"</right> <bottom>"+d+"</bottom> </margins><key><size>16</size><border_color/></key></legend><strings><no_data/><export_as_image/><collecting_data/></strings><labels><label><x>0</x><y>10</y><rotate>false</rotate><width/><align>center</align><text_color/><text_size>"+a+"</text_size><text>"+c+"</text></label></labels></settings>"))}else{if(AC.toLowerCase()=="bar"){L=new SWFObject(Appcelerator.DocumentPath+"swf/amcolumn.swf","chart_"+h,A,E,"8","#FFFFFF");L.addVariable("chart_settings",escape("<settings><type>"+T+"</type><width></width><height>"+O+"</height><data_type>csv</data_type><csv_separator>,</csv_separator><skip_rows>0</skip_rows><font>Arial</font><text_size>"+a+"</text_size><text_color>#000000</text_color><decimals_separator>.</decimals_separator><thousands_separator>,</thousands_separator><redraw>false</redraw><reload_data_interval>0</reload_data_interval><add_time_stamp>false</add_time_stamp><precision>2</precision><depth>"+P+"</depth><angle>"+S+"</angle><export_image_file></export_image_file><column><type>"+k+"</type><width>60</width><spacing>1</spacing><grow_time>"+z+"</grow_time><grow_effect>strong</grow_effect><alpha>100</alpha><border_color>#FFFFFF</border_color><border_alpha></border_alpha><data_labels><![CDATA[]]></data_labels><data_labels_text_color></data_labels_text_color><data_labels_text_size></data_labels_text_size><data_labels_position></data_labels_position>"+r+"<link_target></link_target><gradient></gradient></column><line><connect></connect><width></width><alpha></alpha><fill_alpha>"+M+"</fill_alpha><bullet></bullet><bullet_size></bullet_size><data_labels><![CDATA[{value}]]></data_labels><data_labels_text_color></data_labels_text_color><data_labels_text_size></data_labels_text_size><balloon_text><![CDATA[{value}]]></balloon_text><link_target></link_target></line><background><color>"+C+"</color><alpha>100</alpha><border_color></border_color><border_alpha></border_alpha><file></file></background><plot_area><color></color><alpha></alpha><margins><left>"+I+"</left><top>"+n+"</top><right>"+AB+"</right><bottom>"+d+"</bottom></margins></plot_area><grid><category><color>#000000</color><alpha>5</alpha><dashed>true</dashed><dash_length>5</dash_length></category><value><color>#000000</color><alpha>5</alpha><dashed>false</dashed><dash_length>5</dash_length><approx_count>10</approx_count></value></grid><values><category><enabled>true</enabled><frequency>1</frequency><rotate>"+H+"</rotate><color></color><text_size>"+a+"</text_size></category><value><enabled>true</enabled><min>0</min><max>"+y+"</max><frequency>1</frequency><rotate>"+W+"</rotate><skip_first>true</skip_first><skip_last>false</skip_last><color></color><text_size>"+a+"</text_size><unit></unit><unit_position>right</unit_position><integers_only></integers_only></value></values><axes><category><color>#000000</color><alpha>100</alpha><width>1</width><tick_length>7</tick_length></category><value><color>#000000</color><alpha>100</alpha><width>1</width><tick_length>7</tick_length></value></axes><balloon><enabled>true</enabled><color></color><alpha>80</alpha><text_color></text_color><text_size>"+a+"</text_size></balloon><legend><enabled>"+K+"</enabled><x></x><y>"+Math.floor(E*0.1)+"</y><width></width><color>#FFFFFF</color><alpha>0</alpha><border_color>#000000</border_color><border_alpha>0</border_alpha><text_color></text_color><text_size>"+a+"</text_size><spacing>5</spacing><margins>0</margins><key><size>16</size><border_color></border_color></key></legend><strings><no_data></no_data><export_as_image></export_as_image><collecting_data></collecting_data></strings><labels><label><x>0</x><y>5</y><rotate></rotate><width></width><align>center</align><text_color></text_color><text_size>"+a+"</text_size><text><![CDATA["+c+"]]></text></label>  <label><x>"+u+"</x><y>"+N+"</y><rotate>true</rotate><width></width><align>center</align><text_color></text_color><text_size>"+a+"</text_size><text><![CDATA["+V+"]]></text></label><label><x>"+J+"</x><y>"+f+"</y><rotate>false</rotate><width></width><align>center</align><text_color></text_color><text_size>"+a+"</text_size><text><![CDATA["+G+"]]></text></label>  </labels><graphs>"+t+"</graphs></settings>"))}else{if(AC.toLowerCase()=="line"){L=new SWFObject(Appcelerator.DocumentPath+"swf/amline.swf","chart_"+h,A,E,"8","#FFFFFF");L.addVariable("chart_settings",escape("<settings> <width></width><height>"+O+"</height><data_type>csv</data_type> <type>"+k+"</type> <csv_separator>,</csv_separator> <skip_rows></skip_rows> <font></font> <text_size>"+a+"</text_size> <text_color></text_color> <decimals_separator>.</decimals_separator> <thousands_separator>,</thousands_separator> <redraw></redraw><reload_data_interval></reload_data_interval> <add_time_stamp></add_time_stamp><connect></connect> <hide_bullets_count></hide_bullets_count> <export_image_file></export_image_file><link_target></link_target><background> <color>"+C+"</color> <alpha>100</alpha> <border_color></border_color> <border_alpha></border_alpha> <file></file></background><plot_area> <color></color> <alpha></alpha> <border_color></border_color> <border_alpha></border_alpha> <margins> <left>"+I+"</left> <top>"+n+"</top> <right>"+AB+"</right> <bottom>"+d+"</bottom> </margins> </plot_area><scroller> <enabled></enabled> <y></y> <color></color> <alpha></alpha> <bg_color></bg_color> <bg_alpha></bg_alpha> <height></height> </scroller><grid> <x> <enabled></enabled> <color></color><alpha>5</alpha><dashed>true</dashed><dash_length>5</dash_length> <approx_count>10</approx_count> </x> <y_left> <enabled></enabled> <color></color> <alpha>5</alpha><dashed></dashed><dash_length></dash_length> <approx_count></approx_count> </y_left> <y_right> <enabled></enabled> <color></color> <alpha>5</alpha><dashed></dashed><dash_length></dash_length> <approx_count></approx_count> </y_right> </grid><values> <x> <enabled>true</enabled> <rotate>"+H+"</rotate> <frequency></frequency> <skip_first></skip_first> <skip_last></skip_last> <color></color> <text_size>"+a+"</text_size> </x> <y_left> <enabled>true</enabled> <rotate>"+W+"</rotate> <min></min> <max></max> <strict_min_max></strict_min_max> <frequency></frequency> <skip_first></skip_first> <skip_last></skip_last> <color></color> <text_size>"+a+"</text_size> <unit></unit> <unit_position></unit_position> <integers_only></integers_only> </y_left> <y_right> <enabled></enabled> <rotate>"+W+"</rotate> <min></min> <max></max> <strict_min_max></strict_min_max> <frequency></frequency> <skip_first></skip_first> <skip_last></skip_last> <color></color> <text_size>"+a+"</text_size> <unit></unit> <unit_position></unit_position> <integers_only></integers_only> </y_right> </values><axes> <x> <color></color> <alpha></alpha> <width></width> <tick_length></tick_length> </x> <y_left> <color></color> <alpha></alpha> <width></width> <tick_length></tick_length> </y_left> <y_right> <color></color> <alpha></alpha> <width></width> <tick_length></tick_length> </y_right> </axes><indicator> <enabled>"+g+"</enabled> <zoomable></zoomable> <color></color> <line_alpha></line_alpha> <selection_color></selection_color> <selection_alpha></selection_alpha> <x_balloon_enabled></x_balloon_enabled> <x_balloon_text_color></x_balloon_text_color> <y_balloon_text_size>"+a+"</y_balloon_text_size> <y_balloon_on_off>"+Y+"</y_balloon_on_off> <one_y_balloon>"+b+"</one_y_balloon> </indicator><legend><enabled>"+K+"</enabled> <x></x> <y>"+Math.floor(E*0.1)+"</y> <width></width> <max_columns></max_columns> <color></color> <alpha></alpha> <border_color></border_color> <border_alpha></border_alpha> <text_color></text_color> <text_color_hover></text_color_hover> <text_size>"+a+"</text_size> <spacing>5</spacing> <margins></margins> <graph_on_off>false</graph_on_off> <key> <size></size> <border_color></border_color> <key_mark_color></key_mark_color> </key> <values> <enabled></enabled> <width></width> <align></align> <text><![CDATA[]]></text> </values> </legend><zoom_out_button> <x></x> <y></y> <color></color> <alpha></alpha> <text_color></text_color> <text_color_hover></text_color_hover> <text_size>"+a+"</text_size> <text></text> </zoom_out_button><help> <button> <x></x> <y></y> <color></color> <alpha></alpha> <text_color></text_color> <text_color_hover></text_color_hover> <text_size>"+a+"</text_size> <text></text> </button> <balloon> <color></color> <alpha></alpha> <width></width> <text_color></text_color> <text_size>"+a+"</text_size> <text><![CDATA[]]></text> </balloon> </help><strings> <no_data></no_data> <export_as_image></export_as_image> <error_in_data_file></error_in_data_file> <collecting_data></collecting_data> <wrong_zoom_value></wrong_zoom_value> </strings><labels><label> <x></x> <y>5</y> <rotate></rotate> <width></width> <align>center</align> <text_color></text_color> <text_size>"+a+"</text_size> <text> <![CDATA["+c+"]]> </text> </label></labels> <graphs>"+t+"</graphs></settings>"))}else{throw ('Appcelerator Chart Error: type must be set to either "pie", "bar", "line" or a valid value passed via the incoming property message; "'+AC+'" is not a valid chart type.')}}}if(L!=null){L.addVariable("path",Appcelerator.DocumentPath+"swf/");L.addVariable("chart_data",escape(X));L.addVariable("preloader_color","#FFFFFF");L.write(h)}}};Appcelerator.Widget.registerWithJS("app:chart",Appcelerator.Widget.Chart,["swfobject.js"]);